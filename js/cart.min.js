"use strict";var itemBox=document.querySelectorAll(".product-card__item"),cartCont=document.getElementById("cart-content"),popupCart=document.querySelector(".popup-cart"),nextPopupCart=popupCart.querySelector(".popup-cart__btn-next"),closePopupCart=popupCart.querySelector(".popup-cart__btn-close"),openModalCart=document.querySelector(".popup-cart__btn-form"),modalCart=document.querySelector(".modal-cart");function addEvent(t,e,a){t.addEventListener?t.addEventListener(e,a,!1):t.attachEvent("on"+e,function(){return a.call(t)})}function getCartData(){return JSON.parse(localStorage.getItem("products"))}function setCartData(t){return localStorage.setItem("products",JSON.stringify(t)),!1}function addToCart(){this.disabled=!0;var t=getCartData()||{},e=this.parentNode.parentNode.parentNode,a=this.getAttribute("data-id"),r=e.querySelector(".product-card__title").innerHTML,o=e.querySelector(".product-card__cost").innerHTML;return t.hasOwnProperty(a)?t[a][2]+=1:t[a]=[r,o,1],setCartData(t)||(this.disabled=!1,setTimeout(function(){cartCont.innerHTML=""},100)),!1}document.onclick=(t=>{t.target.classList.contains("product-card__buy")&&(t.preventDefault(),popupCart.classList.add("popup-cart__show"),modalCart.classList.remove("modal-cart__show"))}),nextPopupCart.addEventListener("click",function(t){t.preventDefault(),popupCart.classList.remove("popup-cart__show")}),closePopupCart.addEventListener("click",function(t){t.preventDefault(),popupCart.classList.remove("popup-cart__show")}),window.addEventListener("keydown",function(t){27===t.keyCode&&popupCart.classList.contains("popup-cart__show")&&(t.preventDefault(),ppopupCart.classList.remove("popup-cart__show"))}),openModalCart.addEventListener("click",function(t){t.preventDefault(),modalCart.classList.add("modal-cart__show"),popupCart.classList.remove("popup-cart__show")});for(var i=0;i<itemBox.length;i++)addEvent(itemBox[i].querySelector(".product-card__buy"),"click",addToCart);function openCart(){var t=getCartData(),e="",a=0,r=0;if(null!==t){for(var o in e='<table class="modal-cart__table"><tr><th>Наименование</th><th>Цена</th><th>Кол</th><th>Изм.кол</th></tr>',t){e+="<tr>";for(var n=0;n<t[o].length;n++)e+="<td>"+t[o][n]+"</td>";r+=t[o][1]*t[o][2],a+=t[o][2],e+='<td class="modal-cart__btns"><button class="modal-cart__btn-plus" type="text" aria-label="Увеличить количество" data-id="'+o+'">+</button><button class="modal-cart__btn-minus" type="button" aria-label="Увеличить количество" data-id="'+o+'">-</button><th></th></td>',e+='<td><button class="modal-cart__item-close" type="button" data-id="'+o+'">X</button></td',e+="</tr>"}e+='<tr class="modal-cart__total"><td><strong>Итого</strong></td><td><span>'+r+"</span> Р.</td><td><span>"+a+"</span> шт.</td><td></td></tr>",e+="<table>",cartCont.innerHTML=e}else cartCont.innerHTML="В корзине пусто!";return!1}addEvent(document.getElementById("form"),"click",openCart),addEvent(document.body,"click",function(t){var e=t.target.getAttribute("data-id"),a=getCartData();"modal-cart__btn-plus"===t.target.className&&(a.hasOwnProperty(e)&&(a[e][2]+=1),setCartData(a)||document.getElementById("form").click()),"modal-cart__btn-minus"===t.target.className&&(a.hasOwnProperty(e)&&(a[e][2]>1?a[e][2]-=1:(a[e],delete a[e])),setCartData(a)||document.getElementById("form").click()),"modal-cart__item-close"===t.target.className&&(a.hasOwnProperty(e)&&delete a[e],setCartData(a)||document.getElementById("form").click())},!1),modalCart.addEventListener("click",function(t){t.preventDefault(),modalCart.classList.remove("modal-cart__show")}),window.addEventListener("keydown",function(t){27===t.keyCode&&modalCart.classList.contains("modal-cart__show")&&(t.preventDefault(),modalCart.classList.remove("popup-contact__show"))});
